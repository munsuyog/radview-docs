# Sample Flex Script

A Flex script is created by using various techniques including both recording and manually editing the script. This section demonstrates how a Flex script is created using the recording mechanism, followed by a sample Flex script.

## Manual Script Generation

You can create the AMF JavaScript object manually by describing it as a JavaScript object. Its structure should correspond with that of the AMF JavaScript object that is automatically generated by WebLOAD Recorder. The AMF JavaScript object is made up of elements that represent those of the AMF message, as described in *AMF-Related API Manual* (on page 20).

## What the Script Does

- Demonstrates how to create scripts simulating user actions in websites containing Flex applications.

## How to Create the Script

Create a Flex script by performing the following steps in the WebLOAD Recorder.

### Step 1 -- Record a Flex Application

1. In the WebLOAD Recorder, click ![Record Icon](/images/adobe-flex/sample-flex-script/record-icon.png) to start recording.
2. In the browser that opens, enter the following URL: `http://www.webloadmpstore.com/flex/bin/ProductList.swf`.
3. In the search field, type `webload` and click **Search**.
4. In the WebLOAD Recorder, click ![Stop Record](/images/adobe-flex/sample-flex-script/stop-record.png) to stop recording

The script at this point is as follows:

```javascript
wlGlobals.GetFrames = false;
wlHttp.Header["Referer"] = "http://www.webloadmpstore.com/flex/bin/ProductList.swf";
wlHttp.ContentType = "application/x-amf";
wlHttp.setAmfData = setAmfData;
wlHttp.getAmfData = getAmfData;

amf = new Object;
amf.version = "AMF3";
amf.content = new Array;
amf.content[0] = new Object;
amf.content[0].type = "message";
amf.content[0].length = 14;
amf.content[0].targetUri = "talkback.returnList";
amf.content[0].responseUri = "/1";
amf.content[0].value = new Object;
amf.content[0].value.type = "array";
amf.content[0].value.value = new Array;
amf.content[0].value.value[0] = "webload";
wlHttp.setAmfData(amf);

wlHttp.Post("http://www.webloadmpstore.com/flashservices/gateway.php");
```

A JavaScript object that represents the structure of an AMF message is automatically created during the recording process. The JavaScript object is then automatically converted to a binary object by the `setAmfData(amf)` function and attached to the `wlHttp` object, which is sent to the server in the Post request.

### Step 2 -- Perform Verification on the AMF Message

1. Drag the **Flex - AMF** Building Block from the Verifications toolbox to the node that represents the AMF response in the Script Tree.

    The Flex - AMF dialog box opens.

2. In the AMF Response Parameter Name field enter `content[1].targetUri.value`, in the AMF Response Parameter Value field enter `/1/onResult`, and click **OK**.

**Note:** The JavaScript representation of the AMF messages returned from the server appears in the HTML view. This provides an easy way to extract, analyze, and verify the value returned from the server.

The following script is appended to the script:

```javascript
AMFResponse = wlHttp.getAmfData();
VerifyAMFResponse(AMFResponse, "content[1].targetUri.value", "/1/onResult");
```

The script at this point is as follows:

```javascript
/*** WLIDE - JavaScript - ID:2 ***/
wlGlobals.GetFrames = false;
wlHttp.Header["Referer"] = "http://www.webloadmpstore.com/flex/bin/ProductList.swf";
wlHttp.ContentType = "application/x-amf";
wlHttp.setAmfData = setAmfData;
wlHttp.getAmfData = getAmfData;

amf = new Object;
amf.version = "AMF3";
amf.content = new Array;
amf.content[0] = new Object;
amf.content[0].type = "message";
amf.content[0].length = 14;
amf.content[0].targetUri = "talkback.returnList";
amf.content[0].responseUri = "/1";
amf.content[0].value = new Object;
amf.content[0].value.type = "array";
amf.content[0].value.value = new Array;
amf.content[0].value.value[0] = "webload";
wlHttp.setAmfData(amf);
wlHttp.Post("http://www.webloadmpstore.com/flashservices/gateway.php");
AMFResponse = wlHttp.getAmfData();
VerifyAMFResponse(AMFResponse, "content[1].targetUri.value", "/1/onResult");
// END WLIDE
```